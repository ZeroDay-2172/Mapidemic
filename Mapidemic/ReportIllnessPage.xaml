<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sfComboBox="clr-namespace:Syncfusion.Maui.Inputs;assembly=Syncfusion.Maui.Inputs"
             x:Class="Mapidemic.ReportIllnessPage"
             Title="Report Illness">

        <!-- Page-level styles/colors -->
        <ContentPage.Resources>
                <Style x:Key="FieldLabel"
                       TargetType="Label">
                        <Setter Property="FontSize"
                                Value="16"/>
                        <Setter Property="TextColor"
                                Value="{DynamicResource OnBackground}"/>
                </Style>
                <Style x:Key="InputBorder"
                       TargetType="Border">
                        <Setter Property="Stroke"
                                Value="#E0E0E0"/>
                        <Setter Property="StrokeThickness"
                                Value="1"/>
                        <Setter Property="BackgroundColor"
                                Value="White"/>
                        <Setter Property="Padding"
                                Value="10,6"/>
                        <Setter Property="StrokeShape">
                                <Setter.Value>
                                        <RoundRectangle CornerRadius="10"/>
                                </Setter.Value>
                        </Setter>
                </Style>
                <Style TargetType="Button"
                       x:Key="PrimaryButton">
                        <Setter Property="BackgroundColor"
                                Value="#4C6FFF"/>
                        <Setter Property="TextColor"
                                Value="White"/>
                        <Setter Property="CornerRadius"
                                Value="14"/>
                        <Setter Property="HeightRequest"
                                Value="48"/>
                        <Setter Property="FontSize"
                                Value="16"/>
                </Style>
        </ContentPage.Resources>

        <ScrollView>
                <Grid Padding="24"
                      RowSpacing="18">
                        <Border Grid.Row="0"
                                BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"
                                Stroke="{AppThemeBinding Light=#EEEEEE, Dark=#2B2B2B}"
                                StrokeThickness="1"
                                Padding="20">
                                <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="18"/>
                                </Border.StrokeShape>

                                <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto"
                                      RowSpacing="14">

                                        <Label Text="Help us track illnesses in your area."
                                               FontSize="18"
                                               FontAttributes="Bold"/>

                                        <!-- Illness -->
                                        <Grid Grid.Row="1"
                                              RowSpacing="6">
                                                <Label Text="Illness"
                                                       Style="{StaticResource FieldLabel}"/>
                                                <Border Style="{StaticResource InputBorder}">
                                                        <sfComboBox:SfComboBox x:Name="IllnessPicker"
                                                                               Placeholder="Select an illness"
                                                                               HorizontalOptions="Fill"
                                                                               IsEditable="True"
                                                                               IsFilteringEnabled="True"
                                                                               TextSearchMode="Contains"
                                                                               DisplayMemberPath="Name"
                                                                               SelectedItem="{Binding SelectedIllness}"/>
                                                </Border>
                                                <Label x:Name="IllnessError"
                                                       IsVisible="False"
                                                       Text="Please select an illness."
                                                       FontSize="12"
                                                       TextColor="#D32F2F"/>
                                        </Grid>

                                        <!-- Zip Code -->
                                        <Grid Grid.Row="2"
                                              RowSpacing="6">
                                                <Label Text="ZIP Code"
                                                       Style="{StaticResource FieldLabel}"/>
                                                <Border Style="{StaticResource InputBorder}">
                                                        <Entry x:Name="PostalCodeEntry"
                                                               Placeholder="e.g. 54937"
                                                               Keyboard="Numeric"
                                                               MaxLength="5"
                                                               HorizontalOptions="Fill"
                                                               TextColor="Black"/>
                                                </Border>
                                                <Label x:Name="ZipError"
                                                       IsVisible="False"
                                                       Text="Enter a valid 5-digit ZIP."
                                                       FontSize="12"
                                                       TextColor="#D32F2F"/>
                                        </Grid>

                                        <!-- Status -->
                                        <HorizontalStackLayout Grid.Row="3"
                                                               Spacing="8">
                                                <ActivityIndicator x:Name="BusyIndicator"
                                                                   IsRunning="False"
                                                                   IsVisible="False"/>
                                                <Label x:Name="StatusLabel"
                                                       FontSize="12"
                                                       TextColor="#757575"/>
                                        </HorizontalStackLayout>

                                        <!-- Submit -->
                                        <Button Grid.Row="4"
                                                Text="Report"
                                                Style="{StaticResource PrimaryButton}"
                                                Clicked="OnReportButtonClicked"/>
                                </Grid>
                        </Border>
                </Grid>
        </ScrollView>
</ContentPage>